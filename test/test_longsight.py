import unittest

from ethsnarks.longsight import LongsightF322p5, LongsightF12p5, LongsightL12p5, LongsightL12p5_MP

class MiMCTests(unittest.TestCase):
    def test_LongsightF_322p5(self):
        x_L = 3703141493535563179657531719960160174296085208671919316200479060314459804651
        x_R = 134551314051432487569247388144051420116740427803855572138106146683954151557
        expected = 1955118202659622298192442035507501123132991419752400995882287708761535290053
        actual = LongsightF322p5(x_L, x_R)
        self.assertEqual(actual, expected)

    def test_LongsightF_12p5(self):
        x_L = 3703141493535563179657531719960160174296085208671919316200479060314459804651
        x_R = 134551314051432487569247388144051420116740427803855572138106146683954151557
        expected = 14698330907891059605542875061480191518388361330761392167383706051673460062628
        actual = LongsightF12p5(x_L, x_R)
        self.assertEqual(actual, expected)

    def test_LongsightL_12p5(self):
        x = 3703141493535563179657531719960160174296085208671919316200479060314459804651
        k = 134551314051432487569247388144051420116740427803855572138106146683954151557
        expected = 9638538253242078011815100086590507856430665299520185056351852605094082194804
        actual = LongsightL12p5(x, k)
        self.assertEqual(actual, expected)

    def test_LongsightL12p5_MP(self):
        m_0 = 3703141493535563179657531719960160174296085208671919316200479060314459804651
        m_1 = 134551314051432487569247388144051420116740427803855572138106146683954151557
        iv = 918403109389145570117360101535982733651217667914747213867238065296420114726
        expected = 16743249391414211194903251836323254089433285237756741022465555151301952011503
        actual = LongsightL12p5_MP([m_0, m_1], iv)
        self.assertEqual(actual, expected)


if __name__ == "__main__":
    unittest.main()
